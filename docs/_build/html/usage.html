

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>사용 가이드 &mdash; python-hwpx 1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=61243dd2"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="실전 예제" href="examples.html" />
    <link rel="prev" title="설치 가이드" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            python-hwpx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">시작하기</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">5분 안에 HWPX 문서 다루기</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id1">준비물</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id2">1. 문서 열기와 기본 정보 확인</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id3">2. 새 문단 추가하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id4">3. 표 만들기와 값 채우기</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id5">4. 메모와 필드 컨트롤 추가하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id6">5. 다른 이름으로 저장하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#id7">다음 단계</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">설치 가이드</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id2">요구 사항</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#pypi">PyPI에서 설치</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id3">소스 코드에서 개발용 설치</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id4">설치 검증</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id5">테스트 실행 (선택 사항)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">사용 가이드</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">빠른 예제 모음</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id55">패키지 열기와 기본 점검</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hwpxdocument">HwpxDocument로 문서 편집하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id56">메모 다루기</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id57">스타일 기반 텍스트 변환</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id58">런 서식 지정</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id59">텍스트 추출과 주석 표현</a></li>
<li class="toctree-l2"><a class="reference internal" href="#objectfinder">ObjectFinder로 요소 검색하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id60">변경 사항 저장과 결과물 확인</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">실전 예제</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#id2">1. 보고서 템플릿에 표와 개체 추가하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#id3">2. 하이라이트와 주석을 포함한 텍스트 보고서 생성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#id4">3. 특정 태그를 검색해 요약 정보 만들기</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">심화 주제</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="schema-overview.html">HWPX 스키마 구조와 파이썬 모델 현황</a><ul>
<li class="toctree-l2"><a class="reference internal" href="schema-overview.html#devdoc">DevDoc 스키마 자료 한눈에 보기</a></li>
<li class="toctree-l2"><a class="reference internal" href="schema-overview.html#id1">주요 스키마 세부 구조</a></li>
<li class="toctree-l2"><a class="reference internal" href="schema-overview.html#id2">파이썬 구현 현황 요약</a></li>
<li class="toctree-l2"><a class="reference internal" href="schema-overview.html#id5">주요 누락 요소 및 확장 필요 영역</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">자주 묻는 질문 (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#modulenotfounderror-no-module-named-hwpx"><code class="docutils literal notranslate"><span class="pre">ModuleNotFoundError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'hwpx'</span></code> 오류가 발생합니다.</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#hwpxstructureerror"><code class="docutils literal notranslate"><span class="pre">HwpxStructureError</span></code> 예외가 발생하는 이유는 무엇인가요?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#hwpx-package-hwpxpackage-hwpx-opc-package-hwpxpackage"><code class="docutils literal notranslate"><span class="pre">hwpx.package.HwpxPackage</span></code>와 <code class="docutils literal notranslate"><span class="pre">hwpx.opc.package.HwpxPackage</span></code>의 차이는 무엇인가요?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#http">파일을 메모리 버퍼나 HTTP 응답으로부터 열 수 있나요?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#id1">중첩 문단을 제외하거나 특정 섹션만 순회하려면 어떻게 해야 하나요?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#id2">저장 시 원본 파일을 덮어쓰지 않고 새 파일로 만들고 싶습니다.</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API 참조</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-templates">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.templates</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-package">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.package</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-document">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.document</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-common">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.common</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-body">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.body</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-header">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.header</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-utils">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-schema">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.schema</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-parser">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.parser</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-oxml-document">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.oxml.document</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-opc-package">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.opc.package</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-tools-text-extractor">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.tools.text_extractor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-tools-object-finder">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.tools.object_finder</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-tools-validator">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.tools.validator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#hwpx-init">모듈 <code class="docutils literal notranslate"><span class="pre">hwpx.__init__</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">python-hwpx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">사용 가이드</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/usage.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>사용 가이드<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>python-hwpx-codex는 HWPX 컨테이너를 검증하고 편집하기 위한 여러 계층의 API를 제공합니다. 이 문서에서는 패키지 수준에서 문서를 여는 방법부터 문단과 주석을 다루는 고수준 도구까지 핵심 사용 패턴을 소개합니다.</p>
<section id="id2">
<h2>빠른 예제 모음<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<section id="id3">
<h3>예제 1: 문단 수 세기<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;paragraphs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>예제 2: 빈 템플릿으로 새 문서 생성<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;첫 문단입니다.&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;new-document.hwpx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>예제 3: 특정 단어 일괄 교체<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">replace_text_in_runs</span><span class="p">(</span><span class="s2">&quot;TODO&quot;</span><span class="p">,</span> <span class="s2">&quot;DONE&quot;</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="s2">&quot;#FF0000&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my-document-updated.hwpx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>예제 4: 문서 전체 메모 확인<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">memo</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">memos</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">memo</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">memo</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h3>예제 5: 매니페스트에서 섹션 경로 추출<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">section_paths</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>예제 6: 메모리 버퍼로 저장하기<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<span class="n">raw_bytes</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bytes:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_bytes</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id9">
<h3>예제 7: 다른 파일명으로 저장하기<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output/copy.hwpx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id10">
<h3>예제 8: 바이트 스트림에서 열기<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">raw</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>예제 9: 페이지 크기 확인<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">page_size</span>
<span class="nb">print</span><span class="p">(</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">size</span><span class="o">.</span><span class="n">orientation</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>예제 10: 가로 방향 페이지로 전환<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_page_size</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">297000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">210000</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;LANDSCAPE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>예제 11: 여백 조정하기<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_page_margins</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>예제 12: 번호 매기기 시작값 읽기<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">start_numbering</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">page_starts_on</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">page</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3>예제 13: 번호 매기기 시작값 변경<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_start_numbering</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id16">
<h3>예제 14: 머리말 텍스트 설정<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">header</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_header_text</span><span class="p">(</span><span class="s2">&quot;Confidential&quot;</span><span class="p">,</span> <span class="n">page_type</span><span class="o">=</span><span class="s2">&quot;BOTH&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">apply_page_type</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3>예제 15: 머리말 제거<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">remove_header</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>예제 16: 홀수 페이지 꼬리말 넣기<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_footer_text</span><span class="p">(</span><span class="s2">&quot;© Company&quot;</span><span class="p">,</span> <span class="n">page_type</span><span class="o">=</span><span class="s2">&quot;ODD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id19">
<h3>예제 17: 헤더 파트 이름 나열<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">header</span><span class="o">.</span><span class="n">part_name</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id">
<h3>예제 18: 메모 모양 ID 확인<a class="headerlink" href="#id" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">memo_shapes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</section>
<section id="id20">
<h3>예제 19: 특정 메모 모양 살펴보기<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">memo_shape</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">memo_type</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">line_color</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>예제 20: 두 번째 섹션에 메모 추가<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">memo</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_memo</span><span class="p">(</span><span class="s2">&quot;검토 메모&quot;</span><span class="p">,</span> <span class="n">section_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">memo_shape_id_ref</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memo</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3>예제 21: 메모를 필드와 함께 앵커링<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;앵커 단락&quot;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
<span class="n">memo</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">field_id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_memo_with_anchor</span><span class="p">(</span>
    <span class="s2">&quot;승인 필요&quot;</span><span class="p">,</span>
    <span class="n">paragraph</span><span class="o">=</span><span class="n">paragraph</span><span class="p">,</span>
    <span class="n">memo_shape_id_ref</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s2">&quot;PM&quot;</span><span class="p">,</span>
    <span class="n">created</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">field_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id23">
<h3>예제 22: 조건에 맞는 메모 삭제<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">memo</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">memos</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">memo</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;임시&quot;</span><span class="p">):</span>
        <span class="n">document</span><span class="o">.</span><span class="n">remove_memo</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>예제 23: 새 문자 서식 확보<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">style_id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">ensure_run_style</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;style id:&quot;</span><span class="p">,</span> <span class="n">style_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id25">
<h3>예제 24: 굵고 밑줄 친 런 추가<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;기본 문단&quot;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
<span class="n">paragraph</span><span class="o">.</span><span class="n">add_run</span><span class="p">(</span><span class="s2">&quot;강조 텍스트&quot;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id26">
<h3>예제 25: 기존 런을 기울임 처리<a class="headerlink" href="#id26" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">paragraph</span><span class="o">.</span><span class="n">runs</span><span class="p">:</span>
    <span class="n">paragraph</span><span class="o">.</span><span class="n">runs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3>예제 26: 특정 서식 ID로 런 찾기<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">style_id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">ensure_run_style</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matches</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">find_runs_by_style</span><span class="p">(</span><span class="n">char_pr_id_ref</span><span class="o">=</span><span class="n">style_id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bold runs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="todo">
<h3>예제 27: TODO 한 건만 치환하기<a class="headerlink" href="#todo" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">changed</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">replace_text_in_runs</span><span class="p">(</span><span class="s2">&quot;TODO&quot;</span><span class="p">,</span> <span class="s2">&quot;DONE&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;replaced:&quot;</span><span class="p">,</span> <span class="n">changed</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id28">
<h3>예제 28: 모든 런 텍스트 이어 붙이기<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">all_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">iter_runs</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_text</span><span class="p">[:</span><span class="mi">80</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>예제 29: 첫 문단 텍스트 교체<a class="headerlink" href="#id29" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
    <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;새로운 첫 문단&quot;</span>
</pre></div>
</div>
</section>
<section id="id30">
<h3>예제 30: 첫 런의 텍스트 읽기<a class="headerlink" href="#id30" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span> <span class="ow">and</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">runs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">runs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id31">
<h3>예제 31: 첫 런 삭제<a class="headerlink" href="#id31" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span> <span class="ow">and</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">runs</span><span class="p">:</span>
    <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">runs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id32">
<h3>예제 32: 고정 폭 표 만들기<a class="headerlink" href="#id32" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">54000</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3>예제 33: 표 헤더 병합<a class="headerlink" href="#id33" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id34">
<h3>예제 34: 셀 너비 조정<a class="headerlink" href="#id34" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">cell</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">7200</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id35">
<h3>예제 35: 표 행·열 수 확인<a class="headerlink" href="#id35" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">column_count</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id36">
<h3>예제 36: 도형 삽입<a class="headerlink" href="#id36" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;9000&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;4500&quot;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id37">
<h3>예제 37: 도형 속성 수정<a class="headerlink" href="#id37" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span><span class="s2">&quot;rect&quot;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">shape</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;12000&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id38">
<h3>예제 38: 컨트롤 객체 추가<a class="headerlink" href="#id38" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">control_type</span><span class="o">=</span><span class="s2">&quot;LINE&quot;</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;line1&quot;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id39">
<h3>예제 39: 컨트롤 속성 변경<a class="headerlink" href="#id39" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">control_type</span><span class="o">=</span><span class="s2">&quot;LINE&quot;</span><span class="p">)</span>
<span class="n">control</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;dirty&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id40">
<h3>예제 40: 섹션 파트 이름 확인<a class="headerlink" href="#id40" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">section</span><span class="o">.</span><span class="n">part_name</span> <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id41">
<h3>예제 41: 헤더 경로 목록 확인<a class="headerlink" href="#id41" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">header_paths</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="id42">
<h3>예제 42: 섹션 경로 목록 확인<a class="headerlink" href="#id42" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">section_paths</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="id43">
<h3>예제 43: 패키지 파트 이름 나열<a class="headerlink" href="#id43" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">part_names</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>예제 44: 헤더 파트 바이트 길이 확인<a class="headerlink" href="#id44" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">header_paths</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">header_paths</span><span class="p">()</span>
<span class="k">if</span> <span class="n">header_paths</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">get_part</span><span class="p">(</span><span class="n">header_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;header bytes:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="version-xml">
<h3>예제 45: version.xml 텍스트 읽기<a class="headerlink" href="#version-xml" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">version_text</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;version.xml&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">version_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id45">
<h3>예제 46: version.xml 속성 수정<a class="headerlink" href="#id45" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">version_xml</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="s2">&quot;version.xml&quot;</span><span class="p">)</span>
<span class="n">version_xml</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;writer&quot;</span><span class="p">,</span> <span class="s2">&quot;python-hwpx&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">set_xml</span><span class="p">(</span><span class="s2">&quot;version.xml&quot;</span><span class="p">,</span> <span class="n">version_xml</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id46">
<h3>예제 47: 새 파트 추가하기<a class="headerlink" href="#id46" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">set_part</span><span class="p">(</span><span class="s2">&quot;META-INF/notes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;Generated with python-hwpx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id47">
<h3>예제 48: 문자 서식 ID 나열<a class="headerlink" href="#id47" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">style_id</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">char_properties</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;style:&quot;</span><span class="p">,</span> <span class="n">style_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id48">
<h3>예제 49: 문자 서식 세부 정보 조회<a class="headerlink" href="#id48" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">style_id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">ensure_run_style</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">char_property</span><span class="p">(</span><span class="n">style_id</span><span class="p">)</span>
<span class="k">if</span> <span class="n">style</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">text_color</span><span class="p">(),</span> <span class="n">style</span><span class="o">.</span><span class="n">underline_type</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="id49">
<h3>예제 50: TODO 문단 찾아 출력<a class="headerlink" href="#id49" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;TODO&quot;</span> <span class="ow">in</span> <span class="n">paragraph</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">paragraph</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id50">
<h3>예제 51: 섹션별 문단 수 계산<a class="headerlink" href="#id50" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">section</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">)</span> <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id51">
<h3>예제 52: 현재 여백 값 읽기<a class="headerlink" href="#id51" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">margins</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">page_margins</span>
<span class="nb">print</span><span class="p">(</span><span class="n">margins</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">margins</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id52">
<h3>예제 53: 전체 번호 초기값 설정<a class="headerlink" href="#id52" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">section</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">set_begin_numbering</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id53">
<h3>예제 54: 헤더 번호 초기값 읽기<a class="headerlink" href="#id53" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">begin_numbering</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">begin</span><span class="o">.</span><span class="n">page</span><span class="p">,</span> <span class="n">begin</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id54">
<h3>예제 55: 헤더 번호 초기값 조정<a class="headerlink" href="#id54" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-document.hwpx&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
    <span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_begin_numbering</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id55">
<h2>패키지 열기와 기본 점검<a class="headerlink" href="#id55" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">hwpx.opc.package.HwpxPackage</span></code>는 OPC 컨테이너 전체를 메모리에 적재하면서 필수 파트 존재 여부를 확인합니다. 루트 파일 목록과 <code class="docutils literal notranslate"><span class="pre">version.xml</span></code>에 기록된 메타데이터는 구조 검증과 후속 편집 단계에서 활용할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.opc.package</span> <span class="kn">import</span> <span class="n">HwpxPackage</span>

<span class="n">package</span> <span class="o">=</span> <span class="n">HwpxPackage</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;sample.hwpx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MIME type:&quot;</span><span class="p">,</span> <span class="n">package</span><span class="o">.</span><span class="n">mimetype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Declared root files:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rootfile</span> <span class="ow">in</span> <span class="n">package</span><span class="o">.</span><span class="n">iter_rootfiles</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">rootfile</span><span class="o">.</span><span class="n">full_path</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">rootfile</span><span class="o">.</span><span class="n">media_type</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">package</span><span class="o">.</span><span class="n">main_content</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Main document:&quot;</span><span class="p">,</span> <span class="n">main</span><span class="o">.</span><span class="n">full_path</span><span class="p">)</span>
</pre></div>
</div>
<p>패키지 객체는 임의의 파트를 가져오거나 수정하는 도우미 메서드도 제공합니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">manifest</span> <span class="o">=</span> <span class="n">package</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="s2">&quot;Contents/content.hpf&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spine items:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">manifest</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//{*}item&quot;</span><span class="p">)])</span>
</pre></div>
</div>
</section>
<section id="hwpxdocument">
<h2>HwpxDocument로 문서 편집하기<a class="headerlink" href="#hwpxdocument" title="Link to this heading"></a></h2>
<p>고수준 <code class="docutils literal notranslate"><span class="pre">hwpx.document.HwpxDocument</span></code>는 섹션, 문단, 헤더 파트를 파이썬 객체로 노출하며, 새 문단/표/개체를 생성하는 편의 메서드를 제공합니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.document</span> <span class="kn">import</span> <span class="n">HwpxDocument</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">HwpxDocument</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;sample.hwpx&quot;</span><span class="p">)</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s2">&quot;자동 생성된 문단&quot;</span><span class="p">,</span>
    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
    <span class="n">para_pr_id_ref</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">char_pr_id_ref</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">paragraph</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;outlineLevel&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>

<span class="c1"># 표를 추가하고 헤더 행을 병합합니다.</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">border_fill_id_ref</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_cell_text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Quarter&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_cell_text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Actual&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_cell_text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Forecast&quot;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Q1&quot;</span>

<span class="c1"># 개체와 컨트롤도 문서 또는 문단 수준에서 추가할 수 있습니다.</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
    <span class="s2">&quot;rect&quot;</span><span class="p">,</span>
    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;9000&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;4500&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span>
    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
    <span class="n">control_type</span><span class="o">=</span><span class="s2">&quot;LINE&quot;</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ctrl1&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">HwpxDocument.sections</span></code>, <code class="docutils literal notranslate"><span class="pre">HwpxDocument.paragraphs</span></code>, <code class="docutils literal notranslate"><span class="pre">HwpxDocument.headers</span></code> 속성은 각각 구역, 모든 문단, 헤더 파트를 리스트로 반환합니다. 섹션 속성(<code class="docutils literal notranslate"><span class="pre">section.properties</span></code>)을 사용하면 페이지 크기, 여백, 바탕쪽 연결과 같은 레이아웃 설정도 쉽게 변경할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">properties</span>
<span class="n">options</span><span class="o">.</span><span class="n">set_page_size</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">72000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">43200</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;WIDELY&quot;</span><span class="p">)</span>
<span class="n">options</span><span class="o">.</span><span class="n">set_page_margins</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">footer</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span>

<span class="n">document</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_begin_numbering</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id56">
<h2>메모 다루기<a class="headerlink" href="#id56" title="Link to this heading"></a></h2>
<p>문서에 첨부된 메모는 섹션의 <code class="docutils literal notranslate"><span class="pre">&lt;hp:memogroup&gt;</span></code> 요소와 헤더의 <code class="docutils literal notranslate"><span class="pre">memoProperties</span></code> 정의를 통해 연결됩니다. <code class="docutils literal notranslate"><span class="pre">HwpxDocument.memos</span></code> 속성은 모든 섹션에 포함된 메모 객체를 반환하며, <code class="docutils literal notranslate"><span class="pre">add_memo()</span></code>/<code class="docutils literal notranslate"><span class="pre">remove_memo()</span></code>를 사용하면 새 메모를 생성하거나 삭제할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 메모 모양 정의는 header.ref_list.memo_properties 또는 document.memo_shapes로 조회할 수 있습니다.</span>
<span class="n">default_shape</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">memo_shapes</span><span class="p">))</span>  <span class="c1"># 첫 번째 모양 ID</span>

<span class="n">memo</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_memo</span><span class="p">(</span>
    <span class="s2">&quot;검토 의견을 정리했습니다.&quot;</span><span class="p">,</span>
    <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span>
    <span class="n">memo_shape_id_ref</span><span class="o">=</span><span class="n">default_shape</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">memo</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;표 1은 최신 수치로 업데이트가 필요합니다.&quot;</span>

<span class="k">for</span> <span class="n">existing</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">memos</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">existing</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">existing</span><span class="o">.</span><span class="n">memo_shape_id_ref</span><span class="p">,</span> <span class="n">existing</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="n">document</span><span class="o">.</span><span class="n">remove_memo</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>주의:</strong> 한글 편집기에서 메모 풍선을 표시하려면 본문 문단에 대응되는 MEMO 필드 컨트롤(<code class="docutils literal notranslate"><span class="pre">hp:fieldBegin</span></code>/<code class="docutils literal notranslate"><span class="pre">hp:fieldEnd</span></code>)이 있어야 합니다.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">todo</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;TODO: QA 서명&quot;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">,</span> <span class="n">char_pr_id_ref</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">document</span><span class="o">.</span><span class="n">add_memo_with_anchor</span><span class="p">(</span>
    <span class="s2">&quot;배포 전 QA 서명을 확인하세요.&quot;</span><span class="p">,</span>
    <span class="n">paragraph</span><span class="o">=</span><span class="n">todo</span><span class="p">,</span>
    <span class="n">memo_shape_id_ref</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="n">memo_id</span><span class="o">=</span><span class="s2">&quot;release-memo-qa&quot;</span><span class="p">,</span>
    <span class="n">char_pr_id_ref</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;QA&quot;</span><span class="p">},</span>
    <span class="n">anchor_char_pr_id_ref</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">examples/build_release_checklist.py</span></code>는 이러한 과정을 자동화하여 QA 점검용 문서를 생성하는 스크립트입니다.</p>
</section>
<section id="id57">
<h2>스타일 기반 텍스트 변환<a class="headerlink" href="#id57" title="Link to this heading"></a></h2>
<p>런(<code class="docutils literal notranslate"><span class="pre">HwpxOxmlRun</span></code>)은 <code class="docutils literal notranslate"><span class="pre">charPrIDRef</span></code>를 통해 헤더의 문자 서식(<code class="docutils literal notranslate"><span class="pre">charPr</span></code>)과 연결됩니다. <code class="docutils literal notranslate"><span class="pre">HwpxDocument.find_runs_by_style()</span></code>는 색상, 밑줄 종류, 문자 속성 ID 등의 조건으로 런을 필터링하고, <code class="docutils literal notranslate"><span class="pre">replace_text_in_runs()</span></code>는 선택된 런 내부의 부분 문자열만 치환하거나 삭제합니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 빨간색 텍스트에만 TODO 태그가 남아 있는지 검사합니다.</span>
<span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">find_runs_by_style</span><span class="p">(</span><span class="n">text_color</span><span class="o">=</span><span class="s2">&quot;#FF0000&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;TODO&quot;</span> <span class="ow">in</span> <span class="n">run</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;검토 필요:&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># 빨간색 텍스트에서 TODO를 DONE으로 교체하고, 최대 두 번만 수행합니다.</span>
<span class="n">document</span><span class="o">.</span><span class="n">replace_text_in_runs</span><span class="p">(</span>
    <span class="s2">&quot;TODO&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DONE&quot;</span><span class="p">,</span>
    <span class="n">text_color</span><span class="o">=</span><span class="s2">&quot;#FF0000&quot;</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># 밑줄이 그어진 텍스트에서 임시 주석을 제거합니다.</span>
<span class="n">document</span><span class="o">.</span><span class="n">replace_text_in_runs</span><span class="p">(</span>
    <span class="s2">&quot;(draft)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">underline_type</span><span class="o">=</span><span class="s2">&quot;SOLID&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>반환된 <code class="docutils literal notranslate"><span class="pre">RunStyle</span></code> 객체(<code class="docutils literal notranslate"><span class="pre">run.style</span></code>)를 사용하면 문자 색상, 밑줄 색상 등 서식 속성을 직접 확인할 수 있습니다. 치환기는 단일 <code class="docutils literal notranslate"><span class="pre">&lt;hp:t&gt;</span></code> 하위 요소를 가진 단순 런에 최적화되어 있으며, 텍스트 마크업이 중첩된 복잡한 구조에서는 예상과 다른 결과가 나올 수 있습니다.</p>
</section>
<section id="id58">
<h2>런 서식 지정<a class="headerlink" href="#id58" title="Link to this heading"></a></h2>
<p>헤더의 <code class="docutils literal notranslate"><span class="pre">&lt;hh:charPr&gt;</span></code> 정의는 여러 런이 공유하는 문자 서식을 담고 있습니다. <code class="docutils literal notranslate"><span class="pre">HwpxDocument.ensure_run_style()</span></code>은 굵게/기울임/밑줄 조합에 맞는 <code class="docutils literal notranslate"><span class="pre">charPr</span></code> 항목을 찾아 ID를 반환하고, 필요한 경우 새 항목을 생성합니다. 문단 객체는 <code class="docutils literal notranslate"><span class="pre">add_run()</span></code> 메서드를 통해 해당 서식을 즉시 사용하는 런을 만들 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paragraph</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># 굵은 밑줄 서식을 확보하고, 동일한 서식을 가진 런을 추가합니다.</span>
<span class="n">style_id</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">ensure_run_style</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">paragraph</span><span class="o">.</span><span class="n">add_run</span><span class="p">(</span><span class="s2">&quot;강조된 텍스트&quot;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 반환된 런은 즉시 서식 토글 속성을 제공합니다.</span>
<span class="n">run</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># 새로운 charPr가 생성되고 참조가 갱신됩니다.</span>
<span class="k">assert</span> <span class="n">run</span><span class="o">.</span><span class="n">bold</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">run</span><span class="o">.</span><span class="n">underline</span> <span class="ow">is</span> <span class="kc">True</span>
</pre></div>
</div>
<p>런의 <code class="docutils literal notranslate"><span class="pre">bold</span></code>, <code class="docutils literal notranslate"><span class="pre">italic</span></code>, <code class="docutils literal notranslate"><span class="pre">underline</span></code> 속성은 문서와 연결된 상태에서만 동작하며, 속성을 변경하면 헤더의 <code class="docutils literal notranslate"><span class="pre">charProperties</span></code> 목록과 관련 캐시가 자동으로 업데이트됩니다.</p>
<p>편집이 끝나면 <code class="docutils literal notranslate"><span class="pre">HwpxDocument.save()</span></code>를 호출해 변경 사항을 원본 또는 새 파일에 기록합니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;edited.hwpx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id59">
<h2>텍스트 추출과 주석 표현<a class="headerlink" href="#id59" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">hwpx.tools.text_extractor.TextExtractor</span></code>는 섹션과 문단을 순회하며 텍스트를 문자열로 변환합니다. <code class="docutils literal notranslate"><span class="pre">AnnotationOptions</span></code>를 통해 하이라이트, 각주, 하이퍼링크, 컨트롤 등 주석 요소의 표현 방식을 제어할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.tools.text_extractor</span> <span class="kn">import</span> <span class="n">AnnotationOptions</span><span class="p">,</span> <span class="n">TextExtractor</span>

<span class="n">options</span> <span class="o">=</span> <span class="n">AnnotationOptions</span><span class="p">(</span>
    <span class="n">highlight</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
    <span class="n">footnote</span><span class="o">=</span><span class="s2">&quot;inline&quot;</span><span class="p">,</span>
    <span class="n">endnote</span><span class="o">=</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span>
    <span class="n">note_inline_format</span><span class="o">=</span><span class="s2">&quot;[</span><span class="si">{kind}</span><span class="s2">:</span><span class="si">{text}</span><span class="s2">]&quot;</span><span class="p">,</span>
    <span class="n">note_placeholder</span><span class="o">=</span><span class="s2">&quot;[</span><span class="si">{kind}</span><span class="s2">:</span><span class="si">{inst_id}</span><span class="s2">]&quot;</span><span class="p">,</span>
    <span class="n">hyperlink</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">hyperlink_target_format</span><span class="o">=</span><span class="s2">&quot;[LINK:</span><span class="si">{target}</span><span class="s2">]&quot;</span><span class="p">,</span>
    <span class="n">control</span><span class="o">=</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span>
    <span class="n">control_placeholder</span><span class="o">=</span><span class="s2">&quot;[CTRL </span><span class="si">{name}</span><span class="s2"> </span><span class="si">{type}</span><span class="s2">]&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">TextExtractor</span><span class="p">(</span><span class="s2">&quot;sample.hwpx&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">extractor</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="n">extractor</span><span class="o">.</span><span class="n">iter_document_paragraphs</span><span class="p">():</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">paragraph</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">annotations</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p>문단 객체(<code class="docutils literal notranslate"><span class="pre">ParagraphInfo</span></code>)의 <code class="docutils literal notranslate"><span class="pre">text()</span></code> 메서드에는 추가로 다음과 같은 인자를 전달할 수 있습니다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object_behavior</span></code>: 표, 도형 등 인라인 개체를 <code class="docutils literal notranslate"><span class="pre">&quot;skip&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;placeholder&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nested&quot;</span></code> 중 하나로 처리합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object_placeholder</span></code>: 자리표시자 모드를 사용할 때 형식을 지정합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preserve_breaks</span></code>: 줄바꿈과 탭을 유지할지 여부를 결정합니다.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">iter_sections()</span></code>와 <code class="docutils literal notranslate"><span class="pre">iter_paragraphs()</span></code> 메서드를 사용하면 원하는 구역에만 접근하거나 중첩 문단을 제외하는 등 탐색 범위를 세밀하게 조정할 수 있습니다.</p>
</section>
<section id="objectfinder">
<h2>ObjectFinder로 요소 검색하기<a class="headerlink" href="#objectfinder" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">hwpx.tools.object_finder.ObjectFinder</span></code>는 XPath, 태그/속성 필터를 기반으로 XML 요소를 찾아내는 고수준 API입니다. 텍스트 추출 옵션과 동일한 주석 렌더링 설정을 재사용할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hwpx.tools.object_finder</span> <span class="kn">import</span> <span class="n">ObjectFinder</span>
<span class="kn">from</span> <span class="nn">hwpx.tools.text_extractor</span> <span class="kn">import</span> <span class="n">AnnotationOptions</span>

<span class="n">finder</span> <span class="o">=</span> <span class="n">ObjectFinder</span><span class="p">(</span><span class="s2">&quot;sample.hwpx&quot;</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">AnnotationOptions</span><span class="p">(</span><span class="n">hyperlink</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="s2">&quot;placeholder&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">finder</span><span class="o">.</span><span class="n">iter_annotations</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>특정 태그나 속성을 찾고 싶다면 <code class="docutils literal notranslate"><span class="pre">find_all()</span></code>/<code class="docutils literal notranslate"><span class="pre">find_first()</span></code> 메서드를 사용할 수 있습니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">paragraphs_with_bookmark</span> <span class="o">=</span> <span class="n">finder</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span>
    <span class="n">tag</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;hp:p&quot;</span><span class="p">,</span> <span class="s2">&quot;hp:run&quot;</span><span class="p">),</span>
    <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bookmark&quot;</span><span class="p">)},</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">paragraphs_with_bookmark</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id60">
<h2>변경 사항 저장과 결과물 확인<a class="headerlink" href="#id60" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">HwpxDocument.save()</span></code>는 내부적으로 <code class="docutils literal notranslate"><span class="pre">hwpx.package.HwpxPackage.save()</span></code>를 호출하여 수정된 파트만 새 ZIP 아카이브로 직렬화합니다. 저장 대상 경로를 생략하면 원본 파일을 덮어쓰고, 파일 객체나 바이트 버퍼를 전달하면 인메모리 출력도 지원합니다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">buffer</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>  <span class="c1"># 원본 경로가 없을 때는 bytes 를 반환</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result.hwpx&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
</pre></div>
</div>
<p>패키지 수준에서 바로 작업하고 싶다면 <code class="docutils literal notranslate"><span class="pre">HwpxPackage.set_part()</span></code>/<code class="docutils literal notranslate"><span class="pre">save()</span></code>를 사용해 XML 조각을 교체할 수도 있습니다. 다만 고수준 API(<code class="docutils literal notranslate"><span class="pre">HwpxDocument</span></code>)를 통해 편집한 경우에는 <code class="docutils literal notranslate"><span class="pre">document.save()</span></code>를 호출해 내부 캐시 상태를 깨끗하게 유지하는 것이 좋습니다.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="설치 가이드" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="실전 예제" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, python-hwpx Maintainers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>